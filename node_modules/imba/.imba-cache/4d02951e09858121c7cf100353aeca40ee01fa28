{"id":"d","warnings":[],"errors":[],"js":"function iter$__(a){ let v; return a ? ((v=a.toIterable) ? v.call(a) : a) : a; };;\nfunction defineName$__(cls,name){\n\tObject.defineProperty(cls,\"name\",{value:name,configurable:true});\n};\n\n/*body*/\n// imba$stdlib=1\n\nfunction injectStringBefore(target,toInject,patterns = ['']){\n\t\n\tfor (let $1 = 0, $2 = iter$__(patterns), $3 = $2.length; $1 < $3; $1++) {\n\t\tlet patt = $2[$1];\n\t\tlet idx = target.indexOf(patt);\n\t\tif (idx >= 0) {\n\t\t\t\n\t\t\treturn target.slice(0,idx) + toInject + target.slice(idx);\n\t\t};\n\t};\n\treturn target;\n};\n\nimport fs from 'fs';\n\nclass ImbaAsset {\n\t\n\tconstructor(src){\n\t\t\n\t\tthis.src = src;\n\t}\n\t\n\tget entry(){\n\t\t\n\t\treturn globalThis.IMBA_MANIFEST?.[this.src];\n\t}\n\t\n\tget url(){\n\t\t\n\t\treturn this.entry ? this.entry.url : this.src;\n\t}\n\t\n\tget path(){\n\t\t\n\t\treturn this.entry ? this.entry.path : null;\n\t}\n\t\n\tget body(){\n\t\t\n\t\t\n\t\t\n\t\tif (this.path) {\n\t\t\t\n\t\t\treturn fs.readFileSync(this.path,'utf-8');\n\t\t};\n\t\t;\n\t\treturn null;\n\t}\n\t\n\ttoString(){\n\t\t\n\t\treturn this.url;\n\t}\n\tstatic {\n\t\tdefineName$__(this,'ImbaAsset');}\n};\n\nexport function asset(src){\n\tlet asset;\n\t\n\tif (asset = globalThis.IMBA_MANIFEST?.[src]) {\n\t\t\n\t\treturn new ImbaAsset(src);\n\t\t// return asset.url or asset\n\t};\n\treturn src;\n};\n\nclass HtmlAsset {\n\t\n\tconstructor(text,refs){\n\t\t\n\t\tthis.text = text;\n\t\tthis.refs = refs;\n\t}\n\t\n\tget body(){\n\t\tvar self = this;\n\t\t\n\t\tlet res = this.text.replace(/ASSET_REF_(\\d+)/g,function(m,nr) {\n\t\t\tlet asset;\n\t\t\t\n\t\t\tlet ref = self.refs[nr];\n\t\t\tif (ref instanceof ImbaAsset) {\n\t\t\t\t\n\t\t\t\treturn String(ref);\n\t\t\t};\n\t\t\tif (asset = globalThis.IMBA_MANIFEST?.[String(ref)]) {\n\t\t\t\t\n\t\t\t\treturn asset.url;\n\t\t\t};\n\t\t\treturn ref;\n\t\t});\n\t\t\n\t\tif (globalThis.IMBA_HMR_PATH) {\n\t\t\t\n\t\t\tres = injectStringBefore(res,\"<script src='/__hmr__.js'></script>\",['<!--$head$-->','<!--$body$-->','<html','']);\n\t\t};\n\t\treturn res;\n\t}\n\t\n\ttoString(){\n\t\t\n\t\treturn this.body;\n\t}\n\tstatic {\n\t\tdefineName$__(this,'HtmlAsset');}\n};\n\nexport function html(text,refs){\n\t\n\treturn new HtmlAsset(text,refs);\n};\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXNzZXRzLmltYmEiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJhc3NldHMuaW1iYSJdLCJzb3VyY2VzQ29udGVudCI6WyIjIGltYmEkc3RkbGliPTFcblxuZGVmIGluamVjdFN0cmluZ0JlZm9yZSB0YXJnZXQsIHRvSW5qZWN0LCBwYXR0ZXJucyA9IFsnJ11cblx0Zm9yIHBhdHQgaW4gcGF0dGVybnNcblx0XHRsZXQgaWR4ID0gdGFyZ2V0LmluZGV4T2YocGF0dClcblx0XHRpZiBpZHggPj0gMFxuXHRcdFx0cmV0dXJuIHRhcmdldC5zbGljZSgwLGlkeCkgKyB0b0luamVjdCArIHRhcmdldC5zbGljZShpZHgpXG5cdHJldHVybiB0YXJnZXRcblxuaW1wb3J0IGZzIGZyb20gJ2ZzJ1xuXG5jbGFzcyBJbWJhQXNzZXRcblx0ZGVmIGNvbnN0cnVjdG9yIHNyY1xuXHRcdHNyYyA9IHNyY1xuXHRcblx0Z2V0IGVudHJ5XG5cdFx0Z2xvYmFsLklNQkFfTUFOSUZFU1QuLltzcmNdXG5cblx0Z2V0IHVybFxuXHRcdGVudHJ5ID8gZW50cnkudXJsIDogc3JjXG5cblx0Z2V0IHBhdGhcblx0XHRlbnRyeSA/IGVudHJ5LnBhdGggOiBudWxsXG5cblx0Z2V0IGJvZHlcblx0XHRpZiAkbm9kZSRcblx0XHRcdGlmIHBhdGhcblx0XHRcdFx0cmV0dXJuIGZzLnJlYWRGaWxlU3luYyhwYXRoLCd1dGYtOCcpXG5cdFx0cmV0dXJuIG51bGxcblxuXHRkZWYgdG9TdHJpbmdcblx0XHR1cmxcblxuZXhwb3J0IGRlZiBhc3NldCBzcmNcblx0aWYgbGV0IGFzc2V0ID0gZ2xvYmFsLklNQkFfTUFOSUZFU1QuLltzcmNdXG5cdFx0cmV0dXJuIG5ldyBJbWJhQXNzZXQoc3JjKVxuXHRcdCMgcmV0dXJuIGFzc2V0LnVybCBvciBhc3NldFxuXHRyZXR1cm4gc3JjXG5cbmNsYXNzIEh0bWxBc3NldFxuXHRkZWYgY29uc3RydWN0b3IgdGV4dCxyZWZzXG5cdFx0dGV4dCA9IHRleHRcblx0XHRyZWZzID0gcmVmc1xuXG5cdGdldCBib2R5XG5cdFx0bGV0IHJlcyA9IHRleHQucmVwbGFjZSgvQVNTRVRfUkVGXyhcXGQrKS9nKSBkbyhtLG5yKVxuXHRcdFx0bGV0IHJlZiA9IHJlZnNbbnJdXG5cdFx0XHRpZiByZWYgaXNhIEltYmFBc3NldFxuXHRcdFx0XHRyZXR1cm4gU3RyaW5nKHJlZilcblx0XHRcdGlmIGxldCBhc3NldCA9IGdsb2JhbC5JTUJBX01BTklGRVNULi5bU3RyaW5nKHJlZildXG5cdFx0XHRcdHJldHVybiBhc3NldC51cmxcblx0XHRcdHJldHVybiByZWZcblxuXHRcdGlmIGdsb2JhbC5JTUJBX0hNUl9QQVRIXG5cdFx0XHRyZXMgPSBpbmplY3RTdHJpbmdCZWZvcmUocmVzLFwiPHNjcmlwdCBzcmM9Jy9fX2htcl9fLmpzJz48L3NjcmlwdD5cIixbJzwhLS0kaGVhZCQtLT4nLCc8IS0tJGJvZHkkLS0+JywnPGh0bWwnLCcnXSlcblx0XHRyZXR1cm4gcmVzXG5cblx0ZGVmIHRvU3RyaW5nXG5cdFx0Ym9keVxuXG5leHBvcnQgZGVmIGh0bWwgdGV4dCwgcmVmc1xuXHRyZXR1cm4gbmV3IEh0bWxBc3NldCh0ZXh0LHJlZnMpIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBRUEsUUFBRyxDQUFDLGtCQUFrQixDQUFDLE1BQU0sQ0FBRSxRQUFRLENBQUUsUUFBUSxHQUFHLENBQUMsRUFBRSxDQUFBLENBQUM7O0NBQ3ZELEdBQUcsMkJBQVMsUUFBUSxrQ0FBQTtNQUFoQixJQUFJO0VBQ0gsSUFBQSxHQUFHLEdBQUcsTUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUM7RUFDOUIsRUFBRSxFQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFBOztHQUNWLE1BQU0sQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQztHQUFB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","css":""}