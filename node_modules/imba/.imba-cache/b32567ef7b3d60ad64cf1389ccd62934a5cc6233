{"id":"cb","warnings":[],"errors":[],"js":"function defineName$__(cls,name){\n\tObject.defineProperty(cls,\"name\",{value:name,configurable:true});\n};\nconst $__initor__$ = Symbol.for('#__initor__'), $__inited__$ = Symbol.for('#__inited__'), $__hooks__$ = Symbol.for('#__hooks__');\n\n/*body*/\nimport {commit} from './scheduler';\n\nconst fn = function() { return true; };\n\nclass Storage {\n\t\n\tconstructor(store,ns = ''){\n\t\t\n\t\tthis.store = store || {};\n\t\tthis.cache = {raw: {},rich: {}};\n\t\tthis.ns = ns;\n\t\tthis.local = store == globalThis.sessionStorage;\n\t\tthis.children = new Map;\n\t}\n\t\n\tserialize(val,key){\n\t\t\n\t\treturn JSON.stringify(val);\n\t}\n\t\n\tdeserialize(val,key){\n\t\t\n\t\treturn JSON.parse(val);\n\t}\n\t\n\tgetItem(name){\n\t\t\n\t\tlet key = String(this.ns) + ':' + name;\n\t\t\n\t\tif (this.store instanceof Storage) {\n\t\t\t\n\t\t\treturn this.store.getItem(key);\n\t\t};\n\t\t\n\t\tif (this.local && this.cache.rich[key] != undefined) {\n\t\t\t\n\t\t\treturn this.cache.rich[key];\n\t\t};\n\t\t\n\t\tlet raw = this.store.getItem(key);\n\t\t// if we are \n\t\tif (raw != undefined) {\n\t\t\t\n\t\t\tif (this.cache.raw[key] == raw) {\n\t\t\t\t\n\t\t\t\treturn this.cache.rich[key];\n\t\t\t};\n\t\t\t\n\t\t\tthis.cache.raw[key] = raw;\n\t\t\treturn this.cache.rich[key] = this.deserialize(raw,key);\n\t\t};\n\t}\n\t\n\tsetItem(name,value){\n\t\tvar $1, $2;\n\t\t\n\t\tlet key = String(this.ns) + ':' + name;\n\t\t\n\t\tif (this.store instanceof Storage) {\n\t\t\t\n\t\t\treturn this.store.setItem(key,value);\n\t\t};\n\t\t\n\t\tlet cached = this.cache.rich[key];\n\t\tlet typ = typeof value;\n\t\t\n\t\tif (this.local) {\n\t\t\t\n\t\t\tthis.cache.rich[key] = value;\n\t\t};\n\t\t\n\t\tif (cached !== value || typ == 'object') {\n\t\t\t\n\t\t\tlet prev = this.store.getItem(key);\n\t\t\t\n\t\t\tif (value == undefined) {\n\t\t\t\t\n\t\t\t\tthis.store.removeItem(key);\n\t\t\t\t((($1 = this.cache.rich[key]),delete this.cache.rich[key], $1));\n\t\t\t\t((($2 = this.cache.raw[key]),delete this.cache.raw[key], $2));\n\t\t\t\treturn commit();\n\t\t\t} else {\n\t\t\t\t\n\t\t\t\tlet raw = this.serialize(value,key);\n\t\t\t\tthis.cache.rich[key] = value;\n\t\t\t\tthis.cache.raw[key] = raw;\n\t\t\t\t\n\t\t\t\tif (prev != raw) {\n\t\t\t\t\t\n\t\t\t\t\tthis.store.setItem(key,raw);\n\t\t\t\t\treturn commit();\n\t\t\t\t};\n\t\t\t};\n\t\t};\n\t}\n\t\n\tget(target,key,receiver){\n\t\t\n\t\treturn this.getItem(key);\n\t}\n\t\n\tset(target,key,value,receiver){\n\t\t\n\t\tthis.setItem(key,value);\n\t\treturn true;\n\t}\n\t\n\tapply(target,that,[name]){\n\t\t\n\t\tlet item = this.children.get(name);\n\t\titem || this.children.set(name,item = new Proxy(fn,new Storage(this,name)));\n\t\treturn item;\n\t}\n\t\n\tdeleteProperty(target,name){\n\t\tvar $3;\n\t\t\n\t\tlet key = this.ns + name;\n\t\t((($3 = this.cache[key]),delete this.cache[key], $3));\n\t\treturn this.store.removeItem(key);\n\t}\n\tstatic {\n\t\tdefineName$__(this,'Storage');}\n};\n\nexport const locals = new Proxy(fn,new Storage(globalThis.localStorage));\n\nexport const session = new Proxy(fn,new Storage(globalThis.sessionStorage));\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3RvcmFnZS5pbWJhIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsic3RvcmFnZS5pbWJhIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7Y29tbWl0fSBmcm9tICcuL3NjaGVkdWxlcidcblxuY29uc3QgZm4gPSBkbyB5ZXNcblxuY2xhc3MgU3RvcmFnZVxuXHRkZWYgY29uc3RydWN0b3Igc3RvcmUsIG5zID0gJydcblx0XHRzZWxmLnN0b3JlID0gc3RvcmUgb3Ige31cblx0XHRzZWxmLmNhY2hlID0ge3Jhdzp7fSxyaWNoOnt9fVxuXHRcdHNlbGYubnMgPSBuc1xuXHRcdHNlbGYubG9jYWwgPSBzdG9yZSA9PSBnbG9iYWwuc2Vzc2lvblN0b3JhZ2Vcblx0XHRzZWxmLmNoaWxkcmVuID0gbmV3IE1hcFxuXG5cdGRlZiBzZXJpYWxpemUgdmFsLCBrZXlcblx0XHRKU09OLnN0cmluZ2lmeSh2YWwpXG5cblx0ZGVmIGRlc2VyaWFsaXplIHZhbCwga2V5XG5cdFx0SlNPTi5wYXJzZSh2YWwpXG5cblx0ZGVmIGdldEl0ZW0gbmFtZVxuXHRcdGxldCBrZXkgPSBTdHJpbmcobnMpICsgJzonICsgbmFtZVxuXG5cdFx0aWYgc3RvcmUgaXNhIFN0b3JhZ2Vcblx0XHRcdHJldHVybiBzdG9yZS5nZXRJdGVtKGtleSlcblxuXHRcdGlmIGxvY2FsIGFuZCBjYWNoZS5yaWNoW2tleV0gIT0gdW5kZWZpbmVkXG5cdFx0XHRyZXR1cm4gY2FjaGUucmljaFtrZXldXG5cblx0XHRsZXQgcmF3ID0gc3RvcmUuZ2V0SXRlbShrZXkpXG5cdFx0IyBpZiB3ZSBhcmUgXG5cdFx0aWYgcmF3ICE9IHVuZGVmaW5lZFxuXHRcdFx0aWYgY2FjaGUucmF3W2tleV0gPT0gcmF3XG5cdFx0XHRcdHJldHVybiBjYWNoZS5yaWNoW2tleV1cblxuXHRcdFx0Y2FjaGUucmF3W2tleV0gPSByYXdcblx0XHRcdHJldHVybiBjYWNoZS5yaWNoW2tleV0gPSBkZXNlcmlhbGl6ZShyYXcsa2V5KVxuXG5cdGRlZiBzZXRJdGVtIG5hbWUsIHZhbHVlXG5cdFx0bGV0IGtleSA9IFN0cmluZyhucykgKyAnOicgKyBuYW1lXG5cblx0XHRpZiBzdG9yZSBpc2EgU3RvcmFnZVxuXHRcdFx0cmV0dXJuIHN0b3JlLnNldEl0ZW0oa2V5LHZhbHVlKVxuXG5cdFx0bGV0IGNhY2hlZCA9IGNhY2hlLnJpY2hba2V5XVxuXHRcdGxldCB0eXAgPSB0eXBlb2YgdmFsdWVcblxuXHRcdGlmIGxvY2FsXG5cdFx0XHRjYWNoZS5yaWNoW2tleV0gPSB2YWx1ZVxuXG5cdFx0aWYgY2FjaGVkICE9PSB2YWx1ZSBvciB0eXAgPT0gJ29iamVjdCdcblx0XHRcdGxldCBwcmV2ID0gc3RvcmUuZ2V0SXRlbShrZXkpXG5cdFx0XHRcblx0XHRcdGlmIHZhbHVlID09IHVuZGVmaW5lZFxuXHRcdFx0XHRzdG9yZS5yZW1vdmVJdGVtKGtleSlcblx0XHRcdFx0ZGVsZXRlIGNhY2hlLnJpY2hba2V5XVxuXHRcdFx0XHRkZWxldGUgY2FjaGUucmF3W2tleV1cblx0XHRcdFx0Y29tbWl0IVxuXHRcdFx0ZWxzZVxuXHRcdFx0XHRsZXQgcmF3ID0gc2VyaWFsaXplKHZhbHVlLGtleSlcblx0XHRcdFx0Y2FjaGUucmljaFtrZXldID0gdmFsdWVcblx0XHRcdFx0Y2FjaGUucmF3W2tleV0gPSByYXdcblxuXHRcdFx0XHRpZiBwcmV2ICE9IHJhd1xuXHRcdFx0XHRcdHN0b3JlLnNldEl0ZW0oa2V5LHJhdylcblx0XHRcdFx0XHRjb21taXQhXG5cblx0ZGVmIGdldCB0YXJnZXQsa2V5LHJlY2VpdmVyXG5cdFx0Z2V0SXRlbShrZXkpXG5cblx0ZGVmIHNldCB0YXJnZXQsa2V5LHZhbHVlLHJlY2VpdmVyXG5cdFx0c2V0SXRlbShrZXksdmFsdWUpXG5cdFx0cmV0dXJuIHllc1xuXG5cdGRlZiBhcHBseSB0YXJnZXQsIHRoYXQsIFtuYW1lXVxuXHRcdGxldCBpdGVtID0gY2hpbGRyZW4uZ2V0KG5hbWUpXG5cdFx0aXRlbSB8fCBjaGlsZHJlbi5zZXQobmFtZSxpdGVtID0gbmV3IFByb3h5KGZuLG5ldyBTdG9yYWdlKHNlbGYsbmFtZSkpKVxuXHRcdHJldHVybiBpdGVtXG5cblx0ZGVmIGRlbGV0ZVByb3BlcnR5IHRhcmdldCwgbmFtZVxuXHRcdGxldCBrZXkgPSBucyArIG5hbWVcblx0XHRkZWxldGUgY2FjaGVba2V5XVxuXHRcdHJldHVybiBzdG9yZS5yZW1vdmVJdGVtKGtleSlcblxuZXhwb3J0IGNvbnN0IGxvY2FscyA9IG5ldyBQcm94eShmbixuZXcgU3RvcmFnZShnbG9iYWwubG9jYWxTdG9yYWdlKSlcblxuZXhwb3J0IGNvbnN0IHNlc3Npb24gPSBuZXcgUHJveHkoZm4sbmV3IFN0b3JhZ2UoZ2xvYmFsLnNlc3Npb25TdG9yYWdlKSkiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsTUFBTSxFQUFFLE1BQU0sT0FBTyxhQUFhOztBQUU1QixNQUFBLEVBQUUsR0FBRyxRQUFFLEtBQUMsT0FBQSxJQUFHLEdBQUE7O0FBRWpCLEtBQUssQ0FBQyxPQUFPLEVBQUE7O0NBQ1IsV0FBVyxDQUFDLEtBQUssQ0FBRSxFQUFFLEdBQUcsRUFBRSxDQUFBOztFQUM3QixJQUFJLENBQUMsS0FBSyxHQUFHLEtBQUssQ0FBQyxFQUFFLENBQUMsRUFBRTtFQUN4QixJQUFJLENBQUMsS0FBSyxHQUFHLENBQUMsR0FBRyxFQUFDLEVBQUUsQ0FBQyxJQUFJLEVBQUMsRUFBRSxDQUFDO0VBQzdCLElBQUksQ0FBQyxFQUFFLEdBQUcsRUFBRTtFQUNaLElBQUksQ0FBQyxLQUFLLEdBQUcsS0FBSyxDQUFDLEVBQUUsQ0FBQyxVQUFNLENBQUMsY0FBYztFQUMzQyxJQUFJLENBQUMsUUFBUSxHQUFPLEdBQUQsQ0FBQyxHQUFHO0VBQUE7O0NBRXBCLFNBQVMsQ0FBQyxHQUFHLENBQUUsR0FBRyxDQUFBOztFQUNyQixPQUFBLElBQUksQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDO0VBQUE7O0NBRWhCLFdBQVcsQ0FBQyxHQUFHLENBQUUsR0FBRyxDQUFBOztFQUN2QixPQUFBLElBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDO0VBQUE7O0NBRVosT0FBTyxDQUFDLElBQUksQ0FBQTs7RUFDWCxJQUFBLEdBQUcsR0FBRyxNQUFNLENBQUMsS0FBQSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxJQUFJOztFQUVqQyxFQUFFLEVBQUMsS0FBQSxLQUFLLFlBQUssT0FBTyxFQUFBOztHQUNuQixNQUFNLENBQUMsS0FBQSxLQUFLLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQztHQUFBOztFQUUxQixFQUFFLEVBQUMsS0FBQSxLQUFLLENBQUMsRUFBRyxDQUFDLEtBQUEsS0FBSyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUEsQ0FBRSxFQUFFLENBQUMsU0FBUyxFQUFBOztHQUN4QyxNQUFNLENBQUMsS0FBQSxLQUFLLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQTtHQUFDOztFQUVuQixJQUFBLEdBQUcsR0FBRyxLQUFBLEtBQUssQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDOztFQUU1QixFQUFFLEVBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxTQUFTLEVBQUE7O0dBQ2xCLEVBQUUsRUFBQyxLQUFBLEtBQUssQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFBLENBQUUsRUFBRSxDQUFDLEdBQUcsRUFBQTs7SUFDdkIsTUFBTSxDQUFDLEtBQUEsS0FBSyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUE7SUFBQzs7R0FFdkIsS0FBQSxLQUFLLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQSxHQUFJLEdBQUc7R0FDcEIsTUFBTSxDQUFDLEtBQUEsS0FBSyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUEsR0FBSSxLQUFBLFdBQVcsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDO0dBQUE7RUFBQTs7Q0FFM0MsT0FBTyxDQUFDLElBQUksQ0FBRSxLQUFLLENBQUE7OztFQUNsQixJQUFBLEdBQUcsR0FBRyxNQUFNLENBQUMsS0FBQSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FB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","css":""}